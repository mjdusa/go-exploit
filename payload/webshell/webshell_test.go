package webshell_test

import (
	"strings"
	"testing"

	"github.com/vulncheck-oss/go-exploit/payload/webshell"
)

func TestVerySmallHTTPGET(t *testing.T) {
	shell, param := webshell.PHP.MinimalGet()
	if !strings.HasPrefix(shell, "<?=`$_GET[") {
		t.Fatal("PHP Minimal GET payload is in an unexpected format.")
	}
	if !strings.HasSuffix(shell, "]`?>") {
		t.Fatal("PHP Minimal GET payload is in an unexpected format.")
	}
	if len(param) != 8 {
		t.Fatal("PHP Minimal GET payload is in an unexpected format.")
	}
}
